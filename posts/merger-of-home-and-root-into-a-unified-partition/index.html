<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Merger of Home and Root Into a Unified Partition :: The Journal of Icy-Thought</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="First and Foremost…  I am not responsible over whatever shit that might occur during your migration process. What I am doing in this guide is documenting the process of the migration for my two previous partitions into one unified partition for the sake of seeking this guide when required.
  Getting Started  Have you ever gotten into a situation where you have to clean your /root partitions cache constantly because it keeps getting full?" />
<meta name="keywords" content="Mathematics, Computer Science, Physics, Linux, Biology" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://icy-thought.github.io/Blog/posts/merger-of-home-and-root-into-a-unified-partition/" />




<link rel="stylesheet" href="https://icy-thought.github.io/Blog/assets/style.css">

  <link rel="stylesheet" href="https://icy-thought.github.io/Blog/assets/blue.css">






<link rel="apple-touch-icon" href="https://icy-thought.github.io/Blog/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="https://icy-thought.github.io/Blog/img/favicon/blue.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Merger of Home and Root Into a Unified Partition">
<meta property="og:description" content="First and Foremost…  I am not responsible over whatever shit that might occur during your migration process. What I am doing in this guide is documenting the process of the migration for my two previous partitions into one unified partition for the sake of seeking this guide when required.
  Getting Started  Have you ever gotten into a situation where you have to clean your /root partitions cache constantly because it keeps getting full?" />
<meta property="og:url" content="https://icy-thought.github.io/Blog/posts/merger-of-home-and-root-into-a-unified-partition/" />
<meta property="og:site_name" content="The Journal of Icy-Thought" />

  
    <meta property="og:image" content="https://icy-thought.github.io/Blog/img/favicon/blue.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2021-05-05 00:00:00 &#43;0000 UTC" />












</head>
<body class="blue">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="https://icy-thought.github.io/Blog/">
  <div class="logo">
    The journal of Icy-Thought
  </div>
</a>

    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/Blog/about">About</a></li>
        
      
        
          <li><a href="https://github.com/Icy-Thought/Blog">GitHub Repository</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/Blog/about">About</a></li>
      
    
      
        <li><a href="https://github.com/Icy-Thought/Blog">GitHub Repository</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://icy-thought.github.io/Blog/posts/merger-of-home-and-root-into-a-unified-partition/">Merger of Home and Root Into a Unified Partition</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2021-05-05 
      </span>
    
    
  </div>

  

  

  

  <div class="post-content"><div>
        
<div id="outline-container-headline-1" class="outline-2">
<h2 id="headline-1">
First and Foremost…
</h2>
<div id="outline-text-headline-1" class="outline-text-2">
<p>I am not responsible over whatever shit that might occur during your migration process. What I am doing in this guide is documenting the process of the migration for my two previous partitions into one unified partition for the sake of seeking this guide when required.</p>
</div>
</div>
<div id="outline-container-headline-2" class="outline-2">
<h2 id="headline-2">
Getting Started
</h2>
<div id="outline-text-headline-2" class="outline-text-2">
<p><em>Have you ever gotten into a situation where you have to clean your /root partitions cache constantly because it keeps getting full? And by any chance, did you create a separate /home and /root partition which you now regret doing? If so then this guide is for you!</em></p>
<blockquote>
<p>Before proceeding with anything you need to know this: <strong>do not remove more than the /home partition after backing it up in another partition and it&#39;s also advised that you back up both the partitions in another partition than /root!</strong></p>
</blockquote>
<div class="warning-block">
<p>Before we start off with the guide I need to clarify this that you should apply the commands based on your partition scheme and that this guide is written based on my partition scheme! So please, be cautious and follow this guide with the help of an experienced person if you do not understand what you should do!**</p>
</div>
<div id="outline-container-headline-3" class="outline-3">
<h3 id="headline-3">
Current Partition Scheme
</h3>
<div id="outline-text-headline-3" class="outline-text-3">
<div class="src src-bash">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>arch@archlinux ~<span style="color:#f92672">]</span>$ lsblk
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
loop0    7:0    <span style="color:#ae81ff">0</span>  87.9M  <span style="color:#ae81ff">1</span> loop /var/lib/snapd/snap/core/5548
sda      8:0    <span style="color:#ae81ff">0</span> 465.8G  <span style="color:#ae81ff">0</span> disk
├─sda1   8:1    <span style="color:#ae81ff">0</span>   300M  <span style="color:#ae81ff">0</span> part
├─sda2   8:2    <span style="color:#ae81ff">0</span>   100M  <span style="color:#ae81ff">0</span> part
├─sda3   8:3    <span style="color:#ae81ff">0</span>   128M  <span style="color:#ae81ff">0</span> part
├─sda4   8:4    <span style="color:#ae81ff">0</span> 232.7G  <span style="color:#ae81ff">0</span> part
├─sda5   8:5    <span style="color:#ae81ff">0</span>   550M  <span style="color:#ae81ff">0</span> part /boot
├─sda6   8:6    <span style="color:#ae81ff">0</span>    12G  <span style="color:#ae81ff">0</span> part <span style="color:#f92672">[</span>SWAP<span style="color:#f92672">]</span>
├─sda7   8:7    <span style="color:#ae81ff">0</span>    20G  <span style="color:#ae81ff">0</span> part /
└─sda8   8:8    <span style="color:#ae81ff">0</span>   200G  <span style="color:#ae81ff">0</span> part /home
sr0     11:0    <span style="color:#ae81ff">1</span>  1024M  <span style="color:#ae81ff">0</span> rom</code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-4" class="outline-2">
<h2 id="headline-4">
The surgery
</h2>
<div id="outline-text-headline-4" class="outline-text-2">
<div id="outline-container-headline-5" class="outline-3">
<h3 id="headline-5">
IMPORTANT
</h3>
<div id="outline-text-headline-5" class="outline-text-3">
<ul>
<li>
<p>Make sure to remove cached files which you won&#39;t be needing for this procedure to reduce the amount of time required to backup your files!</p>
</li>
<li>
<p>Backup <code class="verbatim">/home</code>: will later be used to restore all the files after home partition (<code class="verbatim">/dev/sdaX</code>) has been removed and turned into anllocated space.</p>
<ul>
<li>
<p><code>sudo tar czpvf /PATH/TO/BACKUP_PARTITION/home.tar.gz -C /home .</code></p>
</li>
</ul>
</li>
<li>
<p>Backup <code class="verbatim">/root</code>: if something wrong happens throughout the process, this backup would be used to ensure that the process is still replicatable.</p>
<ul>
<li>
<p><strong>Reboot into a LiveUSB</strong> to prevent file loss during the backup process.</p>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-headline-6" class="outline-3">
<h3 id="headline-6">
Before Backup
</h3>
<div id="outline-text-headline-6" class="outline-text-3">
<ul>
<li>
<p><strong>If you want to backup your files in your dual-boot OS</strong> (Windows): you need to install ntfs-3g which will allow you to mount the Windows partition without problems.</p>
<ul>
<li>
<p><code>pacman -S ntfs-3g</code>.</p>
</li>
</ul>
</li>
<li>
<p><code>mkdir /x; mount /dev/sdaX /x</code> (Replace: <em>X</em> = partition, <strong>x</strong> = folder-name).</p>
</li>
<li>
<p><code>mount /dev/sdaX /mnt</code> (<em>X</em> = root-partition), do not mount <code class="verbatim">/home</code> otherwise it will backup alongside the <code class="verbatim">/root</code> backup of the partition.</p>
</li>
<li>
<p><code>tar zcvpf /PATH/TO/BACKUP_PARTITION/root.tar.gz -C /mnt .</code></p>
</li>
<li>
<p><strong>When the backup has finished without returning errors</strong> =&gt; reboot and later check the files in the new archived folder to confirm that the files had indeed finished the backup process without trouble.</p>
</li>
<li>
<p>Reboot to LiveUSB or just ignore this and finish the rest of this guide.</p>
</li>
</ul>
</div>
</div>
<div id="outline-container-headline-7" class="outline-3">
<h3 id="headline-7">
After Backup
</h3>
<div id="outline-text-headline-7" class="outline-text-3">
<ol>
<li>
<p>Boot into your LiveUSB.</p>
</li>
<li>
<p>Confirm that you are either using GPT or MBR through <code>gdisk /dev/sda</code>.</p>
</li>
<li>
<p>Type <code>p</code> -&gt; hit enter and you should be greeted with the current partition scheme.</p>
</li>
<li>
<p>Type <code>d</code> to remove partition and then <code>X</code> (replace <em>X</em> with the number for your <code class="verbatim">/home</code> partition)</p>
</li>
<li>
<p>Repeat step 3, but replace <em>X</em> with the number for the <code class="verbatim">root</code> partition.</p>
<ol>
<li>
<p>If the process was successful, there should be no file loss from your <code class="verbatim">root</code> partition due to the creation of a merged partition rather than the deletion of the partition, which would transfer the files to the new partition instead of removing them.</p>
</li>
</ol>
</li>
<li>
<p><em>During the writing of this guide, <strong>I had used two EXT4 partitions</strong> for both partitions</em>, therefore you should note that the method is different for other partition types. (Hexcode number: 8300)</p>
</li>
<li>
<p>Type ~n` to create a new partition and later choose the number for your partition with the block size set from the <code class="verbatim">start sector</code> to the <code class="verbatim">end sector</code>.</p>
<ol>
<li>
<p>Double check your <code class="verbatim">start sector</code> and your <code class="verbatim">end sector</code>.</p>
</li>
</ol>
</li>
<li>
<p>Type <code>p</code> to check the partition scheme and ensure that the new partition = <code class="verbatim">/home + /root</code> size and make sure to check the Hexcode number for the partition is the same as it previously was. (Hexcode number = 8300).</p>
</li>
<li>
<p>If you are satisfied with the new partition, type <code>w</code> to write the new partition.</p>
</li>
<li>
<p>Expand the filesystem using <code>resize2fs</code>:</p>
<ol>
<li>
<p><code>resize2fs /dev/sdaX</code>, where <em>X</em> = number of the new created partition.</p>
</li>
<li>
<p>If it returns <code>e2fck -f /dev/sdaX`</code>, then execute that command + the <code class="verbatim">resize2fs</code> command afterwards.</p>
</li>
</ol>
</li>
<li>
<p>Mount the newly expanded partition to <code class="verbatim">/mnt</code>:</p>
<ol>
<li>
<p><code>mount /dev/sdaX /mnt</code></p>
</li>
<li>
<p>Do: <code>ls /mnt</code> to check if your old <code class="verbatim">/root</code> files are still present.</p>
</li>
</ol>
</li>
<li>
<p><code>mkdir /x; mount /dev/sdaX /x</code> and locate your saved <code class="verbatim">/home.tar.gz</code> file using <code>cd</code>.</p>
</li>
<li>
<p><code>tar -zxpvf /PATH/TO/home.tar.gz -C /mnt/home</code> to unpack your files to <code class="verbatim">/home</code> directory.</p>
</li>
<li>
<p>Remove old <code class="verbatim">/home</code> partition from <code class="verbatim">fstab</code> from another window, <code>CTRL+ALT+F3</code>, through <code>nano /mnt/etc/fstab</code> + remove old lines for <code class="verbatim">/home</code>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="outline-container-headline-8" class="outline-2">
<h2 id="headline-8">
Lastly
</h2>
<div id="outline-text-headline-8" class="outline-text-2">
<ol>
<li>
<p>To ensure that the process is working as expected do <code>ls -l /mnt/home/</code>.</p>
<ol>
<li>
<p>It should <strong>not</strong> be <code>0</code> because the old files in <code class="verbatim">/home</code> have transferred to the new <code class="verbatim">/root</code> partition!</p>
</li>
</ol>
</li>
<li>
<p>Return to the window where you ran the tar command through <code>CTRL+ALT+F3</code>, when the process has finished run <code>sync</code>.</p>
</li>
<li>
<p>Check your files through <code>ls</code> and if you are satisfied…. <code>reboot</code>.</p>
</li>
</ol>
</div>
</div>
<div id="outline-container-headline-9" class="outline-2">
<h2 id="headline-9">
Good Job!
</h2>
<div id="outline-text-headline-9" class="outline-text-2">
<p>Now you have one unified partition rather than two :P</p>
</div>
</div>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://icy-thought.github.io/Blog/posts/leagueclient-could-not-be-found/">
                <span class="button__icon">←</span>
                <span class="button__text">LeagueClient Could Not Be Found...</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://icy-thought.github.io/Blog/posts/setup-systemd-resolve/">
                <span class="button__text">Setup Systemd Resolve</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2021 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://icy-thought.github.io/Blog/assets/main.js"></script>
<script src="https://icy-thought.github.io/Blog/assets/prism.js"></script>







  
</div>

</body>
</html>
